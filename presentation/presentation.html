<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å³æ™‚ç«¶æ¨™èˆ‡é™æ™‚æ¶è³¼ç³»çµ±</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/theme/night.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/monokai.css">
    <style>
        :root {
            --r-background-color: #1a1a2e;
            --r-main-color: #eaeaea;
            --r-heading-color: #00d9ff;
        }
        .reveal h1, .reveal h2, .reveal h3 { text-transform: none; font-weight: 700; }
        .reveal h1 { font-size: 2em; }
        .reveal h2 { font-size: 1.4em; color: #00d9ff; margin-bottom: 20px; }
        .reveal h3 { font-size: 0.95em; color: #7dd3fc; margin-bottom: 8px; }
        .reveal section { height: 100%; }
        .reveal table { font-size: 0.55em; margin: 0 auto; border-collapse: collapse; }
        .reveal table th { background: #0f3460; color: #00d9ff; }
        .reveal table td, .reveal table th { padding: 5px 10px; border: 1px solid #334; }
        .reveal pre { font-size: 0.45em; width: 100%; margin: 8px 0; }
        .reveal pre code { padding: 10px; }
        .reveal ul { display: block; text-align: left; margin-left: 1em; }
        .reveal ol { display: block; text-align: left; margin-left: 1em; }
        .reveal li { margin: 0.3em 0; font-size: 0.7em; }
        .reveal code { background: #16213e; padding: 2px 5px; border-radius: 4px; font-size: 0.85em; }

        .highlight-box {
            background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
            border-left: 4px solid #00d9ff;
            padding: 12px 16px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.7em;
        }
        .metric-card {
            background: linear-gradient(135deg, #1e3a5f 0%, #0f3460 100%);
            padding: 12px 16px;
            border-radius: 10px;
            margin: 5px;
            display: inline-block;
            min-width: 120px;
        }
        .metric-card .value { font-size: 1.4em; font-weight: bold; color: #00d9ff; }
        .metric-card .label { font-size: 0.6em; color: #94a3b8; }
        .tech-badge {
            background: #0f3460;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.55em;
            margin: 4px;
            display: inline-block;
        }
        .check { color: #10b981; }
        .subtitle { color: #94a3b8; font-size: 0.85em; }

        .arch-container { display: flex; flex-direction: column; align-items: center; gap: 6px; }
        .arch-box {
            background: #16213e;
            border: 2px solid #0f3460;
            padding: 8px 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.5em;
        }
        .arch-box.client { border-color: #3b82f6; min-width: 320px; }
        .arch-box.ingress { border-color: #8b5cf6; min-width: 320px; }
        .arch-box.service { border-color: #10b981; min-width: 130px; }
        .arch-box.data { border-color: #f59e0b; min-width: 90px; }
        .arch-row { display: flex; gap: 15px; justify-content: center; align-items: flex-start; }
        .arch-arrow { color: #64748b; font-size: 0.65em; }

        .layer-box {
            background: #16213e;
            border-left: 4px solid;
            padding: 6px 12px;
            margin: 5px 0;
            border-radius: 0 8px 8px 0;
            text-align: left;
            font-size: 0.55em;
        }
        .layer-box.l1 { border-color: #ef4444; }
        .layer-box.l2 { border-color: #f59e0b; }
        .layer-box.l3 { border-color: #10b981; }
        .layer-box.l4 { border-color: #3b82f6; }

        .two-col { display: flex; gap: 20px; align-items: flex-start; }
        .two-col > div { flex: 1; }

        .three-col { display: flex; gap: 15px; align-items: flex-start; }
        .three-col > div { flex: 1; }

        .small-table { font-size: 0.5em !important; }
        .small-table td, .small-table th { padding: 3px 6px !important; }

        .flow-diagram {
            background: #16213e;
            border-radius: 8px;
            padding: 10px;
            font-family: monospace;
            font-size: 0.42em;
            line-height: 1.4;
            text-align: left;
            white-space: pre;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">

            <!-- ========== Slide 1: å°é¢ ========== -->
            <section style="display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative;">
                <div>
                    <h1>å³æ™‚ç«¶æ¨™èˆ‡é™æ™‚æ¶è³¼ç³»çµ±</h1>
                    <p class="subtitle">åˆ†æ•£å¼ç³»çµ±èˆ‡é›²ç«¯æ‡‰ç”¨é–‹ç™¼å¯¦å‹™ â€” æœŸæœ«å°ˆæ¡ˆ</p>
                </div>
                <div style="position: absolute; bottom: 15%; left: 50%; transform: translateX(-50%); text-align: center; font-size: 0.65em; color: #94a3b8;">
                    ç¬¬åä¸€çµ„<br>
                    çµ„å“¡ : æå¤é§¿ é„§åŠ›ç‘‹
                </div>
            </section>

            <!-- ========== Slide 2: ç›®éŒ„ ========== -->
            <section style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
                <div style="width: 100%;">
                    <h2 style="margin-bottom: 30px;">ç›®éŒ„</h2>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; padding: 0 20px;">
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #00d9ff; padding: 18px 20px; border-radius: 8px; text-align: left;">
                            <span style="font-size: 1.8em; font-weight: bold; color: #00d9ff; opacity: 0.3; float: right; margin-top: -5px;">01</span>
                            <div style="font-size: 0.7em; color: #00d9ff; font-weight: bold;">å°ˆæ¡ˆç›®æ¨™èˆ‡éœ€æ±‚</div>
                            <div style="font-size: 0.45em; color: #94a3b8; margin-top: 5px;">ç³»çµ±å®šä½ Â· æ ¸å¿ƒåŠŸèƒ½ Â· æ•ˆèƒ½ç›®æ¨™</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #10b981; padding: 18px 20px; border-radius: 8px; text-align: left;">
                            <span style="font-size: 1.8em; font-weight: bold; color: #10b981; opacity: 0.3; float: right; margin-top: -5px;">02</span>
                            <div style="font-size: 0.7em; color: #10b981; font-weight: bold;">ç³»çµ±èˆ‡éƒ¨ç½²æ¶æ§‹</div>
                            <div style="font-size: 0.45em; color: #94a3b8; margin-top: 5px;">GKE Â· HPA Â· é€£ç·šæ± é…ç½®</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #f59e0b; padding: 18px 20px; border-radius: 8px; text-align: left;">
                            <span style="font-size: 1.8em; font-weight: bold; color: #f59e0b; opacity: 0.3; float: right; margin-top: -5px;">03</span>
                            <div style="font-size: 0.7em; color: #f59e0b; font-weight: bold;">è³‡æ–™åº« Schema</div>
                            <div style="font-size: 0.45em; color: #94a3b8; margin-top: 5px;">ER Diagram Â· è¡¨æ ¼å®šç¾© Â· ç´¢å¼•</div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px; padding: 0 120px;">
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #8b5cf6; padding: 18px 20px; border-radius: 8px; text-align: left;">
                            <span style="font-size: 1.8em; font-weight: bold; color: #8b5cf6; opacity: 0.3; float: right; margin-top: -5px;">04</span>
                            <div style="font-size: 0.7em; color: #8b5cf6; font-weight: bold;">æ ¸å¿ƒæœå‹™èˆ‡è³‡æ–™æµ</div>
                            <div style="font-size: 0.45em; color: #94a3b8; margin-top: 5px;">è¨ˆåˆ†å…¬å¼ Â· å‡ºåƒ¹æµç¨‹ Â· çµç®—æµç¨‹ Â· å››å±¤é˜²è¶…è³£</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #ef4444; padding: 18px 20px; border-radius: 8px; text-align: left;">
                            <span style="font-size: 1.8em; font-weight: bold; color: #ef4444; opacity: 0.3; float: right; margin-top: -5px;">05</span>
                            <div style="font-size: 0.7em; color: #ef4444; font-weight: bold;">API è¨­è¨ˆ</div>
                            <div style="font-size: 0.45em; color: #94a3b8; margin-top: 5px;">REST API Â· WebSocket Â· å³æ™‚æ¨æ’­</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 3: å°ˆæ¡ˆç›®æ¨™ ========== -->
            <section>
                <h2>å°ˆæ¡ˆç›®æ¨™èˆ‡æ ¸å¿ƒåŠŸèƒ½</h2>
                <div class="highlight-box" style="font-size: 0.8em;">
                    å°ˆç‚º<strong style="color: #00d9ff;">é«˜ä¸¦ç™¼å ´æ™¯</strong>è¨­è¨ˆçš„å³æ™‚ç«¶æ¨™ç³»çµ±<br>
                    æ´»å‹•çµæŸæ™‚ï¼Œæ’åå‰ K åç”¨æˆ¶è‡ªå‹•æˆç‚ºå¾—æ¨™è€…
                </div>
                <div style="margin: 20px 0;">
                    <div class="metric-card"><div class="value">1000+</div><div class="label">ä¸¦ç™¼ç”¨æˆ¶ VUs</div></div>
                    <div class="metric-card"><div class="value">æ¯«ç§’ç´š</div><div class="label">å‡ºåƒ¹éŸ¿æ‡‰</div></div>
                    <div class="metric-card"><div class="value">O(log N)</div><div class="label">æ’åæŸ¥è©¢</div></div>
                    <div class="metric-card"><div class="value">100%</div><div class="label">åº«å­˜ä¸€è‡´æ€§</div></div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px; margin-top: 25px; padding: 0 20px;">
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #00d9ff; padding: 20px 24px; border-radius: 10px; text-align: left;">
                        <div style="font-size: 0.75em; color: #00d9ff; font-weight: bold; margin-bottom: 8px;">âš¡ å³æ™‚ç«¶æ¨™</div>
                        <div style="font-size: 0.55em; color: #94a3b8; line-height: 1.5;">ç”¨æˆ¶å°å•†å“å‡ºåƒ¹ï¼Œç³»çµ±å³æ™‚è¨ˆç®—æ’å</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #10b981; padding: 20px 24px; border-radius: 10px; text-align: left;">
                        <div style="font-size: 0.75em; color: #10b981; font-weight: bold; margin-bottom: 8px;">â° é™æ™‚æ¶è³¼</div>
                        <div style="font-size: 0.55em; color: #94a3b8; line-height: 1.5;">æ´»å‹•çµæŸæ™‚ï¼Œæ’åå‰ K åç”¨æˆ¶è‡ªå‹•æˆç‚ºå¾—æ¨™è€…</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #f59e0b; padding: 20px 24px; border-radius: 10px; text-align: left;">
                        <div style="font-size: 0.75em; color: #f59e0b; font-weight: bold; margin-bottom: 8px;">ğŸ›¡ï¸ åº«å­˜ä¿è­·</div>
                        <div style="font-size: 0.55em; color: #94a3b8; line-height: 1.5;">å››å±¤é˜²è¶…è³£æ©Ÿåˆ¶ç¢ºä¿åº«å­˜ä¸€è‡´æ€§<br><span style="color: #00d9ff;">(orders â‰¤ stock)</span></div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 4px solid #8b5cf6; padding: 20px 24px; border-radius: 10px; text-align: left;">
                        <div style="font-size: 0.75em; color: #8b5cf6; font-weight: bold; margin-bottom: 8px;">ğŸ“¡ å³æ™‚æ¨æ’­</div>
                        <div style="font-size: 0.55em; color: #94a3b8; line-height: 1.5;">WebSocket æ¨é€æ’åæ›´æ–°èˆ‡æ´»å‹•çµæœ</div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 3: ç³»çµ±æ¶æ§‹ ========== -->
            <section>
                <h2>ç³»çµ±æ¶æ§‹</h2>
                <div class="arch-container">
                    <div class="arch-box client">
                        <strong>Client Layer</strong><br>
                        React 18 + TypeScript + Vite
                    </div>
                    <div class="arch-arrow">â–¼ HTTP / WebSocket</div>
                    <div class="arch-box ingress">
                        <strong>GCP Ingress (L7)</strong><br>
                        /api/* & /ws/* â†’ Backend &nbsp;&nbsp; /* â†’ Frontend
                    </div>
                    <div class="arch-arrow" style="display: flex; justify-content: center; gap: 180px;">
                        <span>â–¼</span>
                        <span>â–¼</span>
                    </div>
                    <div class="arch-row" style="align-items: flex-start;">
                        <div class="arch-box service">
                            <strong>Backend</strong><br>
                            FastAPI + Uvicorn<br>
                            5-50 Pods (HPA)
                        </div>
                        <div class="arch-box service">
                            <strong>Frontend</strong><br>
                            Nginx + Static<br>
                            1-5 Pods (HPA)
                        </div>
                    </div>
                    <div class="arch-arrow" style="margin-right: 160px;">â–¼</div>
                    <div class="arch-row" style="margin-right: 160px;">
                        <div class="arch-box data">
                            <strong>Redis</strong><br>
                            Memorystore<br>1GB
                        </div>
                        <div class="arch-box data">
                            <strong>PgBouncer</strong><br>
                            6 Pods<br>Transaction
                        </div>
                    </div>
                    <div class="arch-arrow" style="margin-right: 160px;">â–¼</div>
                    <div class="arch-box data" style="margin-right: 160px;">
                        <strong>PostgreSQL</strong><br>
                        Cloud SQL<br>2vCPU/4GB
                    </div>
                </div>
            </section>

            <!-- ========== Slide 4: é›²ç«¯é…ç½® ========== -->
            <section>
                <h2>é›²ç«¯éƒ¨ç½²é…ç½®</h2>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 12px; padding: 0 10px;">
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 10px 12px; border-radius: 6px; text-align: left;">
                        <div style="font-size: 0.65em; color: #00d9ff; font-weight: bold; margin-bottom: 3px;">Backend</div>
                        <div style="font-size: 0.45em; color: #94a3b8; margin-bottom: 2px;">FastAPI + Uvicorn</div>
                        <div style="font-size: 0.42em; color: #64748b;">5-50 Pods (HPA)</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #10b981; padding: 10px 12px; border-radius: 6px; text-align: left;">
                        <div style="font-size: 0.65em; color: #10b981; font-weight: bold; margin-bottom: 3px;">Frontend</div>
                        <div style="font-size: 0.45em; color: #94a3b8; margin-bottom: 2px;">React 18 + Nginx</div>
                        <div style="font-size: 0.42em; color: #64748b;">1-5 Pods (HPA)</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #f59e0b; padding: 10px 12px; border-radius: 6px; text-align: left;">
                        <div style="font-size: 0.65em; color: #f59e0b; font-weight: bold; margin-bottom: 3px;">PgBouncer</div>
                        <div style="font-size: 0.45em; color: #94a3b8; margin-bottom: 2px;">Connection Pooler</div>
                        <div style="font-size: 0.42em; color: #64748b;">6 Pods, Transaction</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #8b5cf6; padding: 10px 12px; border-radius: 6px; text-align: left;">
                        <div style="font-size: 0.65em; color: #8b5cf6; font-weight: bold; margin-bottom: 3px;">Redis</div>
                        <div style="font-size: 0.45em; color: #94a3b8; margin-bottom: 2px;">GCP Memorystore</div>
                        <div style="font-size: 0.42em; color: #64748b;">1GB, Redis 7.0</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #ef4444; padding: 10px 12px; border-radius: 6px; text-align: left;">
                        <div style="font-size: 0.65em; color: #ef4444; font-weight: bold; margin-bottom: 3px;">PostgreSQL</div>
                        <div style="font-size: 0.45em; color: #94a3b8; margin-bottom: 2px;">Cloud SQL 15</div>
                        <div style="font-size: 0.42em; color: #64748b;">2vCPU/4GB, max=200</div>
                    </div>
                </div>
                <div style="margin-top: 18px;">
                    <div style="font-size: 1.1em; color: #00d9ff; font-weight: bold; margin-bottom: 12px; text-align: center;">é€£ç·šæ± æ¶æ§‹</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 0 10px;">
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 14px 16px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.7em; color: #00d9ff; font-weight: bold; margin-bottom: 6px;">Backend Pods (æœ€å¤š 50 å€‹)</div>
                            <div style="font-size: 0.52em; color: #94a3b8; margin-bottom: 4px;">SQLAlchemy AsyncEngine</div>
                            <div style="font-size: 0.48em; color: #64748b; margin-bottom: 3px;">pool_size=8, max_overflow=15</div>
                            <div style="font-size: 0.52em; color: #00d9ff; font-weight: bold;">â†’ æ¯ Pod æœ€å¤š 23 é€£ç·š</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #f59e0b; padding: 14px 16px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.7em; color: #f59e0b; font-weight: bold; margin-bottom: 6px;">PgBouncer (6 Replicas)</div>
                            <div style="font-size: 0.52em; color: #94a3b8; margin-bottom: 4px;">Transaction Mode</div>
                            <div style="font-size: 0.48em; color: #64748b; margin-bottom: 3px;">max_client_conn=2000</div>
                            <div style="font-size: 0.48em; color: #64748b; margin-bottom: 3px;">max_db_connections=30/pod</div>
                            <div style="font-size: 0.52em; color: #f59e0b; font-weight: bold;">â†’ å…± 180 DB é€£ç·š</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #ef4444; padding: 14px 16px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.7em; color: #ef4444; font-weight: bold; margin-bottom: 6px;">Cloud SQL PostgreSQL</div>
                            <div style="font-size: 0.52em; color: #94a3b8; margin-bottom: 4px;">PostgreSQL 15</div>
                            <div style="font-size: 0.48em; color: #64748b; margin-bottom: 3px;">2 vCPU / 4GB RAM / 10GB SSD</div>
                            <div style="font-size: 0.52em; color: #ef4444; font-weight: bold;">max_connections=200</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(0, 217, 255, 0.1); border-radius: 6px; display: inline-block; min-width: 160px;">
                        <div style="font-size: 0.8em; color: #00d9ff; font-weight: bold; margin-bottom: 4px;">é€£ç·šè¤‡ç”¨æ¯”</div>
                        <div style="font-size: 1.3em; color: #00d9ff; font-weight: bold;">6.4 : 1</div>
                        <div style="font-size: 0.65em; color: #94a3b8; margin-top: 5px;">1,150 : 180</div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 5: HPA èˆ‡ K8s é…ç½® ========== -->
            <section>
                <h2>HPA æ“´å±•ç­–ç•¥èˆ‡ K8s é…ç½®</h2>
                <div class="two-col">
                    <div>
                        <h3>HPA æ“´å±•ç­–ç•¥</h3>
                        <table class="small-table">
                            <thead><tr><th>æ–¹å‘</th><th>ç­–ç•¥</th><th>èªªæ˜</th></tr></thead>
                            <tbody>
                                <tr><td style="color:#10b981;"><strong>Scale Up</strong></td><td>ç„¡ç©©å®šçª—å£<br>æ¯ 15 ç§’ +10 pods</td><td>æµé‡æš´å¢å¿«é€Ÿæ‡‰å°</td></tr>
                                <tr><td style="color:#ef4444;"><strong>Scale Down</strong></td><td>5 åˆ†é˜ç©©å®šæœŸ<br>æ¯ 60 ç§’ -2 pods</td><td>é¿å…ç¸®å®¹æŠ–å‹•</td></tr>
                            </tbody>
                        </table>
                        <div class="highlight-box" style="margin-top: 10px;">
                            <strong>è§¸ç™¼æ¢ä»¶</strong><br>
                            Backend: CPU > 50% â†’ æ“´å±• (5-50 Pods)<br>
                            Frontend: CPU > 70% â†’ æ“´å±• (1-5 Pods)
                        </div>
                    </div>
                    <div>
                        <h3>Kubernetes è³‡æºé…ç½®</h3>
                        <table class="small-table">
                            <thead><tr><th>è³‡æºé¡å‹</th><th>åç¨±</th><th>èªªæ˜</th></tr></thead>
                            <tbody>
                                <tr><td>Namespace</td><td>flash-sale</td><td>å°ˆæ¡ˆéš”é›¢å‘½åç©ºé–“</td></tr>
                                <tr><td>Deployment</td><td>backend</td><td>å–® worker/Pod + HPA æ°´å¹³æ“´å±•</td></tr>
                                <tr><td>Deployment</td><td>frontend</td><td>Nginx éœæ…‹æª”æ¡ˆæœå‹™</td></tr>
                                <tr><td>Deployment</td><td>pgbouncer</td><td>6 Replicas é€£ç·šæ± ä»£ç†</td></tr>
                                <tr><td>Service</td><td>ClusterIP</td><td>å…§éƒ¨æœå‹™ç™¼ç¾</td></tr>
                                <tr><td>Ingress</td><td>GCP L7 LB</td><td>/api/*, /ws/* â†’ Backend, /* â†’ Frontend</td></tr>
                                <tr><td>HPA</td><td>backend-hpa</td><td>CPU 50% è§¸ç™¼ï¼Œ5-50 Pods</td></tr>
                                <tr><td>HPA</td><td>frontend-hpa</td><td>CPU 70% è§¸ç™¼ï¼Œ1-5 Pods</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <h3 style="font-size: 0.95em; color: #00d9ff; margin-bottom: 10px; text-align: center;">Docker æ˜ åƒé…ç½®</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 0 10px;">
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 12px 14px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.65em; color: #00d9ff; font-weight: bold; margin-bottom: 5px;">Backend</div>
                            <div style="font-size: 0.5em; color: #94a3b8; margin-bottom: 4px;">python:3.11-slim-bookworm</div>
                            <div style="font-size: 0.45em; color: #64748b;">Multi-stage build, UV å¥—ä»¶ç®¡ç†<br>uvloop + httptools</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #10b981; padding: 12px 14px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.65em; color: #10b981; font-weight: bold; margin-bottom: 5px;">Frontend</div>
                            <div style="font-size: 0.5em; color: #94a3b8; margin-bottom: 4px;">nginx:1.25-alpine</div>
                            <div style="font-size: 0.45em; color: #64748b;">Multi-stage build<br>Node 18 å»ºç½®, Nginx éœæ…‹æœå‹™</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #f59e0b; padding: 12px 14px; border-radius: 6px; text-align: left;">
                            <div style="font-size: 0.65em; color: #f59e0b; font-weight: bold; margin-bottom: 5px;">PgBouncer</div>
                            <div style="font-size: 0.5em; color: #94a3b8; margin-bottom: 4px;">edoburu/pgbouncer</div>
                            <div style="font-size: 0.45em; color: #64748b;">è¼•é‡é€£ç·šæ± ä»£ç†</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 6: è³‡æ–™åº«è¨­è¨ˆ ========== -->
            <section>
                <h2>è³‡æ–™åº« Schema è¨­è¨ˆ</h2>
                <div class="two-col">
                    <div>
                        <h3>ER Diagram</h3>
                        <div class="flow-diagram" style="font-size: 0.38em;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   users    â”‚           â”‚    bids    â”‚           â”‚ campaigns  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ user_id PK â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ user_id FK â”‚     â”Œâ”€â”€â”€â”€â–ºâ”‚campaign_id â”‚
â”‚ email      â”‚     1:M   â”‚ campaign_idâ”œâ”€â”€â”€â”€â”€â”˜     â”‚ product_id â”‚
â”‚ username   â”‚           â”‚ price      â”‚    M:1    â”‚ start_time â”‚
â”‚ weight     â”‚           â”‚ score      â”‚           â”‚ end_time   â”‚
â”‚ is_admin   â”‚           â”‚ UNIQUE     â”‚           â”‚ alpha/beta â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚(camp,user) â”‚           â”‚ gamma      â”‚
      â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                                 â”‚
      â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
      â”‚           1:M    â”‚   orders   â”‚    M:1          â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ order_id PKâ”‚
                         â”‚ final_priceâ”‚
                         â”‚ final_rank â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ UNIQUE     â”‚     â”‚  products  â”‚
                         â”‚(camp,user) â”‚ M:1 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â–ºâ”‚ product_id â”‚
                                            â”‚ stock      â”‚
                                            â”‚ min_price  â”‚
                                            â”‚ version    â”‚
                                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
                    </div>
                    <div>
                        <h3>è¡¨æ ¼å®šç¾©</h3>
                        <table class="small-table">
                            <thead><tr><th>è¡¨æ ¼</th><th>ä¸»è¦æ¬„ä½</th><th>ç‰¹æ®Šç´„æŸ</th></tr></thead>
                            <tbody>
                                <tr><td><strong>users</strong></td><td>user_id, email, username, weight, is_admin</td><td>UNIQUE(email)</td></tr>
                                <tr><td><strong>products</strong></td><td>product_id, name, stock, min_price, version</td><td>CHECK(stock>=0)</td></tr>
                                <tr><td><strong>campaigns</strong></td><td>campaign_id, product_id, start/end_time, Î±/Î²/Î³</td><td>CHECK(end>start)</td></tr>
                                <tr><td><strong>bids</strong></td><td>bid_id, campaign_id, user_id, price, score</td><td>UNIQUE(camp,user)</td></tr>
                                <tr><td><strong>orders</strong></td><td>order_id, campaign_id, user_id, final_price/rank</td><td>UNIQUE(camp,user)</td></tr>
                            </tbody>
                        </table>
                        <h3 style="margin-top: 12px;">é—œéµç´¢å¼•</h3>
                        <table class="small-table">
                            <thead><tr><th>è¡¨æ ¼</th><th>ç´¢å¼•</th><th>ç”¨é€”</th></tr></thead>
                            <tbody>
                                <tr><td>bids</td><td>idx_bids_campaign_score</td><td>æ’åæŸ¥è©¢</td></tr>
                                <tr><td>bids</td><td>uq_bids_campaign_user</td><td>UPSERT æ”¯æ´</td></tr>
                                <tr><td>campaigns</td><td>idx_campaigns_status</td><td>ç‹€æ…‹ç¯©é¸</td></tr>
                                <tr><td>campaigns</td><td>idx_campaigns_time</td><td>æ™‚é–“ç¯„åœæŸ¥è©¢</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 7: è¨ˆåˆ†å…¬å¼ ========== -->
            <section>
                <h2>è¨ˆåˆ†å…¬å¼</h2>
                <div class="highlight-box" style="font-size: 1em; text-align: center; max-width: 900px; margin: 0 auto; padding: 15px 20px;">
                    <div style="font-size: 1.3em; color: #00d9ff; white-space: nowrap; letter-spacing: 0.3px;">
                        <strong>Score = Î± Ã— P + Î² / (T + 1) + Î³ Ã— W</strong>
                    </div>
                </div>
                <div class="two-col" style="margin-top: 20px;">
                    <div>
                        <h3>åƒæ•¸èªªæ˜</h3>
                        <table class="small-table">
                            <thead><tr><th>åƒæ•¸</th><th>èªªæ˜</th><th>é è¨­å€¼</th></tr></thead>
                            <tbody>
                                <tr><td><strong>P</strong></td><td>å‡ºåƒ¹é‡‘é¡</td><td>ç”¨æˆ¶è¼¸å…¥</td></tr>
                                <tr><td><strong>T</strong></td><td>æ´»å‹•é–‹å§‹å¾Œç¶“éçš„æ¯«ç§’æ•¸</td><td>ç³»çµ±è¨ˆç®—</td></tr>
                                <tr><td><strong>W</strong></td><td>æœƒå“¡æ¬Šé‡</td><td>0.5 - 5.0</td></tr>
                                <tr><td><strong>K</strong></td><td>å•†å“åº«å­˜ï¼ˆå¾—æ¨™åé¡ï¼‰</td><td>æ´»å‹•è¨­å®š</td></tr>
                                <tr><td><strong>Î±</strong></td><td>åƒ¹æ ¼æ¬Šé‡ä¿‚æ•¸</td><td>1.0000</td></tr>
                                <tr><td><strong>Î²</strong></td><td>æ™‚é–“æ¬Šé‡ä¿‚æ•¸</td><td>1000.0000</td></tr>
                                <tr><td><strong>Î³</strong></td><td>æœƒå“¡æ¬Šé‡ä¿‚æ•¸</td><td>100.0000</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <h3>è¨­è¨ˆç†å¿µ</h3>
                        <div class="highlight-box" style="padding: 10px 14px; font-size: 0.85em;">
                            <strong style="color: #00d9ff;">è¶Šé«˜å‡ºåƒ¹</strong> â†’ è¶Šé«˜åˆ†æ•¸ (Î± Ã— P)<br>
                            <strong style="color: #00d9ff;">è¶Šæ—©å‡ºåƒ¹</strong> â†’ è¶Šé«˜åˆ†æ•¸ (Î² / (T + 1))<br>
                            <strong style="color: #00d9ff;">è¶Šé«˜æœƒå“¡ç­‰ç´š</strong> â†’ è¶Šé«˜åˆ†æ•¸ (Î³ Ã— W)
                        </div>
                        <div class="highlight-box" style="margin-top: 8px; padding: 10px 14px;">
                            <strong>ç¯„ä¾‹è¨ˆç®—</strong><br>
                            <div style="font-size: 0.85em; line-height: 1.5;">
                                å‡è¨­ï¼š<strong style="color: #00d9ff;">å‡ºåƒ¹é‡‘é¡ P = 5000</strong>ï¼Œ<strong style="color: #00d9ff;">æ´»å‹•é–‹å§‹å¾Œ T = 1000 æ¯«ç§’</strong>ï¼Œ<strong style="color: #00d9ff;">æœƒå“¡æ¬Šé‡ W = 3.0</strong><br>
                                <span style="color: #94a3b8;">åƒ¹æ ¼åˆ†æ•¸é …ï¼š</span> Î± Ã— P = 1.0 Ã— 5000 = <strong style="color: #10b981;">5000</strong><br>
                                <span style="color: #94a3b8;">æ™‚é–“åˆ†æ•¸é …ï¼š</span> Î² / (T + 1) = 1000 / (1000 + 1) = <strong style="color: #10b981;">0.999</strong><br>
                                <span style="color: #94a3b8;">æœƒå“¡åˆ†æ•¸é …ï¼š</span> Î³ Ã— W = 100 Ã— 3.0 = <strong style="color: #10b981;">300</strong><br>
                                <span style="color: #94a3b8;">ç¸½åˆ†æ•¸ï¼š</span> Score = 5000 + 0.999 + 300 = <strong style="color: #00d9ff; font-size: 1.05em;">5300.999</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 8: å‡ºåƒ¹æµç¨‹ ========== -->
            <section>
                <h2>å‡ºåƒ¹æµç¨‹</h2>
                <div class="two-col">
                    <div>
                        <h3 style="margin-bottom: 6px;">æµç¨‹åœ–</h3>
                        <div class="arch-container" style="gap: 2px;">
                            <div class="arch-box client" style="min-width: 180px; padding: 4px 14px;">
                                <strong>Client</strong><br>
                                POST /api/v1/bids
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #ef4444; min-width: 180px; padding: 4px 14px;">
                                <strong>Rate Limiter</strong><br>
                                Redis Lua Script
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #8b5cf6; min-width: 180px; padding: 4px 14px;">
                                <strong>Campaign Validation</strong><br>
                                Redis Cache é©—è­‰
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #10b981; min-width: 180px; padding: 4px 14px;">
                                <strong>Calculate Score</strong><br>
                                Î±Ã—P + Î²/(T+1) + Î³Ã—W
                            </div>
                            <div class="arch-arrow" style="display: flex; justify-content: center; gap: 60px; font-size: 0.55em;">
                                <span>â–¼</span>
                                <span>â–¼</span>
                            </div>
                            <div class="arch-row" style="gap: 8px;">
                                <div class="arch-box data" style="min-width: 85px; padding: 4px 10px;">
                                    <strong>PostgreSQL</strong><br>
                                    UPSERT
                                </div>
                                <div class="arch-box data" style="border-color: #8b5cf6; min-width: 85px; padding: 4px 10px;">
                                    <strong>Redis</strong><br>
                                    Pipeline
                                </div>
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #3b82f6; min-width: 180px; padding: 4px 14px;">
                                <strong>WebSocket</strong><br>
                                bid_accepted æ¨æ’­
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 style="margin-bottom: 3px;">é—œéµæŠ€è¡“ï¼šUPSERT</h3>
                        <pre style="margin: 3px 0; font-size: 0.4em;"><code class="language-python" style="max-height: none; overflow: visible; padding: 6px;">stmt = pg_insert(Bid).values(
    campaign_id=cid, user_id=uid,
    price=price, score=score,
)
stmt = stmt.on_conflict_do_update(
    index_elements=['campaign_id', 'user_id'],
    set_={
        'price': price, 'score': score,
        'bid_number': Bid.bid_number + 1
    }
)</code></pre>
                        <p style="font-size: 0.5em; color: #94a3b8; margin-top: 3px; margin-bottom: 0;">
                            <span class="check">âœ“</span> INSERT ... ON CONFLICT DO UPDATE<br>
                            <span class="check">âœ“</span> å–®ä¸€ SQLï¼ŒåŸå­æ“ä½œ<br>
                            <span class="check">âœ“</span> æ¶ˆé™¤ç«¶æ…‹æ¢ä»¶
                        </p>
                        <h3 style="margin-top: 8px; margin-bottom: 3px;">Redis Pipeline</h3>
                        <p style="font-size: 0.5em; color: #94a3b8; margin: 0;">
                            ZADD + HSET + ZREVRANK åˆä½µç‚º <strong style="color:#00d9ff;">1 RTT</strong><br>
                            æ¸›å°‘ <strong style="color:#00d9ff;">40-60%</strong> å»¶é²
                        </p>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 9: çµç®—æµç¨‹ ========== -->
            <section>
                <h2>çµç®—æµç¨‹</h2>
                <div class="two-col" style="gap: 15px;">
                    <div>
                        <h3 style="margin-bottom: 6px; font-size: 0.9em;">æµç¨‹åœ–</h3>
                        <div class="arch-container" style="gap: 2px;">
                            <div class="arch-box" style="border-color: #3b82f6; min-width: 200px; padding: 4px 14px;">
                                <strong>Background Loop</strong><br>
                                æ¯ 10 ç§’åŸ·è¡Œä¸€æ¬¡
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #10b981; min-width: 200px; padding: 4px 14px;">
                                <strong>Query Campaigns</strong><br>
                                status='active' & end_time &lt; now
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #8b5cf6; min-width: 200px; padding: 4px 14px;">
                                <strong>Get Top K</strong><br>
                                Redis ZREVRANGE
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box" style="border-color: #ef4444; min-width: 200px; padding: 5px 14px;">
                                <strong>Four-Layer Protection</strong><br>
                                <span style="font-size: 0.8em; color: #94a3b8;">
                                    L1: åˆ†æ•£å¼é– / L2: Lua åŸå­æ‰£æ¸›<br>
                                    L3: è¡Œç´šé– / L4: æ¨‚è§€é–
                                </span>
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box data" style="min-width: 200px; padding: 4px 14px;">
                                <strong>Create Orders</strong><br>
                                PostgreSQL INSERT
                            </div>
                            <div class="arch-arrow" style="font-size: 0.55em;">â–¼</div>
                            <div class="arch-box client" style="min-width: 200px; padding: 4px 14px;">
                                <strong>WebSocket Broadcast</strong><br>
                                campaign_ended æ¨æ’­
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 style="margin-bottom: 2px; font-size: 0.9em;">çµç®—ç¨‹å¼ç¢¼</h3>
                        <pre style="margin: 2px 0; font-size: 0.36em;"><code class="language-python" style="max-height: none; overflow: visible; padding: 6px; line-height: 1.25;">async def settlement_loop():
    while True:
        campaigns = await get_ended_campaigns()
        for campaign in campaigns:
            # å¾ Redis å–å¾— Top K æ’å
            winners = await redis.zrevrange(
                f"bid:{campaign.id}",
                0, campaign.stock - 1,
                withscores=True
            )
            # åŸ·è¡Œå››å±¤ä¿è­· + å»ºç«‹è¨‚å–®
            for rank, (user_id, score) in enumerate(winners):
                await create_order_with_protection(
                    campaign, user_id, score, rank + 1
                )
            campaign.status = 'ended'
            await broadcast_campaign_end(campaign)
        await asyncio.sleep(10)</code></pre>
                        <p style="font-size: 0.48em; color: #94a3b8; margin-top: 4px; margin-bottom: 0; line-height: 1.4;">
                            <span class="check">âœ“</span> æ¯ 10 ç§’æª¢æŸ¥å·²çµæŸæ´»å‹•<br>
                            <span class="check">âœ“</span> Redis ZREVRANGE å–å¾— Top K<br>
                            <span class="check">âœ“</span> å››å±¤ä¿è­·ç¢ºä¿åº«å­˜ä¸€è‡´
                        </p>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 10: å››å±¤é˜²è¶…è³£ ========== -->
            <section>
                <h2>å››å±¤é˜²è¶…è³£æ©Ÿåˆ¶</h2>
                <p style="font-size: 0.65em; color: #94a3b8; margin-bottom: 10px;">
                    å•é¡Œï¼šé«˜ä¸¦ç™¼çµç®—æ™‚å¦‚ä½•ç¢ºä¿ <strong style="color:#00d9ff;">orders â‰¤ stock</strong>ï¼Ÿ
                </p>
                <div style="max-width: 750px; margin: 0 auto;">
                    <div class="layer-box l1" style="display: flex; justify-content: space-between; align-items: center; padding: 8px 14px;">
                        <div>
                            <strong>L1: Redis åˆ†æ•£å¼é–</strong> â€” <code>SET lock:product:{id} NX EX 2</code>
                        </div>
                        <span style="color:#94a3b8; font-size: 0.9em; white-space: nowrap; margin-left: 10px;">åºåˆ—åŒ–ä¸¦ç™¼è«‹æ±‚</span>
                    </div>
                    <div class="layer-box l2" style="display: flex; justify-content: space-between; align-items: center; padding: 8px 14px;">
                        <div>
                            <strong>L2: Redis Lua åŸå­æ‰£æ¸›</strong> â€” <code>if stock >= 1 then DECR</code>
                        </div>
                        <span style="color:#94a3b8; font-size: 0.9em; white-space: nowrap; margin-left: 10px;">å¿«é€Ÿåº«å­˜æª¢æŸ¥</span>
                    </div>
                    <div class="layer-box l3" style="display: flex; justify-content: space-between; align-items: center; padding: 8px 14px;">
                        <div>
                            <strong>L3: PostgreSQL è¡Œç´šé–</strong> â€” <code>SELECT ... FOR UPDATE</code>
                        </div>
                        <span style="color:#94a3b8; font-size: 0.9em; white-space: nowrap; margin-left: 10px;">é–å®šè©²è¡Œè³‡æ–™</span>
                    </div>
                    <div class="layer-box l4" style="display: flex; justify-content: space-between; align-items: center; padding: 8px 14px;">
                        <div>
                            <strong>L4: æ¨‚è§€é–ç‰ˆæœ¬æª¢æŸ¥</strong> â€” <code>UPDATE WHERE version = ?</code>
                        </div>
                        <span style="color:#94a3b8; font-size: 0.9em; white-space: nowrap; margin-left: 10px;">æœ€çµ‚ä¸€è‡´æ€§ä¿è­‰</span>
                    </div>
                </div>
                <div class="two-col" style="margin-top: 12px; gap: 15px;">
                    <pre style="margin: 0; font-size: 0.42em;"><code class="language-lua" style="max-height: none; overflow: visible; padding: 8px; line-height: 1.4;">-- Redis Lua: åº«å­˜åŸå­æ‰£æ¸›
local stock = tonumber(redis.call("GET", KEYS[1]))
if stock and stock >= 1 then
    return redis.call("DECR", KEYS[1])
else
    return -1  -- åº«å­˜ä¸è¶³
end</code></pre>
                    <pre style="margin: 0; font-size: 0.42em;"><code class="language-python" style="max-height: none; overflow: visible; padding: 8px; line-height: 1.4;"># PostgreSQL æ¨‚è§€é–
result = await session.execute(
    update(Product)
    .where(Product.id == pid)
    .where(Product.version == current_ver)
    .values(stock=Product.stock - 1,
            version=current_ver + 1)
)
if result.rowcount == 0:
    raise OptimisticLockError()</code></pre>
                </div>
            </section>

            <!-- ========== Slide 11: Redis è³‡æ–™çµæ§‹èˆ‡æ’åæ•ˆèƒ½ ========== -->
            <section>
                <h2>Redis è³‡æ–™çµæ§‹èˆ‡æ’åæ•ˆèƒ½</h2>
                <div class="two-col" style="gap: 15px;">
                    <div>
                        <h3 style="margin-bottom: 5px; font-size: 0.9em; margin-top: 0;">Redis è³‡æ–™çµæ§‹</h3>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 5px; margin-bottom: 8px;">
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 8px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.58em; color: #00d9ff; font-weight: bold; margin-bottom: 3px;"><code style="background: transparent; padding: 0;">bid:{campaign_id}</code></div>
                                <div style="font-size: 0.48em; color: #94a3b8;">Sorted Set Â· æ’å (user_id â†’ score)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #10b981; padding: 8px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.58em; color: #10b981; font-weight: bold; margin-bottom: 3px;"><code style="background: transparent; padding: 0;">bid_details:{cid}:{uid}</code></div>
                                <div style="font-size: 0.48em; color: #94a3b8;">Hash Â· å‡ºåƒ¹è©³æƒ… (price, username)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #f59e0b; padding: 8px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.58em; color: #f59e0b; font-weight: bold; margin-bottom: 3px;"><code style="background: transparent; padding: 0;">stock:{product_id}</code></div>
                                <div style="font-size: 0.48em; color: #94a3b8;">String Â· å³æ™‚åº«å­˜è¨ˆæ•¸å™¨</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #8b5cf6; padding: 8px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.58em; color: #8b5cf6; font-weight: bold; margin-bottom: 3px;"><code style="background: transparent; padding: 0;">lock:product:{pid}</code></div>
                                <div style="font-size: 0.48em; color: #94a3b8;">String Â· åˆ†æ•£å¼é– (TTL 2ç§’)</div>
                            </div>
                        </div>
                        <h3 style="margin-top: 5px; margin-bottom: 5px; font-size: 0.9em;">æ’åæŸ¥è©¢æ•ˆèƒ½</h3>
                        <table class="small-table" style="font-size: 0.48em;">
                            <thead><tr><th>æ“ä½œ</th><th>æ™‚é–“è¤‡é›œåº¦</th></tr></thead>
                            <tbody>
                                <tr><td>æ›´æ–°æ’å (ZADD)</td><td>O(log N)</td></tr>
                                <tr><td>æŸ¥è©¢å–®äººæ’å (ZREVRANK)</td><td>O(log N)</td></tr>
                                <tr><td>å–å¾— Top K (ZREVRANGE)</td><td>O(log N + K)</td></tr>
                                <tr><td>ç¸½åƒèˆ‡äººæ•¸ (ZCARD)</td><td>O(1)</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <h3 style="margin-bottom: 8px; font-size: 0.95em;">Pipeline å„ªåŒ–</h3>
                        <pre style="margin: 0 0 10px 0; font-size: 0.4em;"><code class="language-python" style="max-height: none; overflow: visible; padding: 8px; line-height: 1.4;"># å‚³çµ±åšæ³•ï¼š3 æ¬¡ RTT
await redis.zadd(key, {uid: score})  # RTT 1
await redis.hset(details_key, data)  # RTT 2
rank = await redis.zrevrank(key, uid)  # RTT 3

# Pipelineï¼š1 æ¬¡ RTT
pipe = redis.pipeline()
pipe.zadd(key, {uid: score})
pipe.hset(details_key, data)
pipe.zrevrank(key, uid)
results = await pipe.execute()  # åªéœ€ 1 RTT!</code></pre>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <div class="metric-card" style="min-width: 100px; padding: 10px 14px;"><div class="value" style="font-size: 1.2em;">40-60%</div><div class="label" style="font-size: 0.55em;">å»¶é²æ¸›å°‘</div></div>
                            <div class="metric-card" style="min-width: 100px; padding: 10px 14px;"><div class="value" style="font-size: 1.2em;">1 RTT</div><div class="label" style="font-size: 0.55em;">vs 3 RTT</div></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 12: API è¨­è¨ˆ ========== -->
            <section>
                <h2>API è¨­è¨ˆ</h2>
                <div class="two-col" style="gap: 15px;">
                    <div>
                        <h3 style="margin-bottom: 4px; font-size: 0.9em; margin-top: 0;">REST API ç«¯é»</h3>
                        <table class="small-table" style="font-size: 0.42em; line-height: 1.1;">
                            <thead><tr><th>æ–¹æ³•</th><th>ç«¯é»</th><th>èªªæ˜</th><th>èªè­‰</th></tr></thead>
                            <tbody>
                                <tr><td>POST</td><td><code>/api/v1/auth/register</code></td><td>ç”¨æˆ¶è¨»å†Š</td><td>-</td></tr>
                                <tr><td>POST</td><td><code>/api/v1/auth/login</code></td><td>ç”¨æˆ¶ç™»å…¥ï¼Œå–å¾— JWT</td><td>-</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/auth/me</code></td><td>å–å¾—ç•¶å‰ç”¨æˆ¶è³‡è¨Š</td><td>Required</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/products</code></td><td>å•†å“åˆ—è¡¨</td><td>-</td></tr>
                                <tr><td>POST</td><td><code>/api/v1/products</code></td><td>å»ºç«‹å•†å“</td><td>Admin</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/campaigns</code></td><td>æ´»å‹•åˆ—è¡¨</td><td>-</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/campaigns/{id}</code></td><td>æ´»å‹•è©³æƒ…ï¼ˆå«çµ±è¨ˆï¼‰</td><td>-</td></tr>
                                <tr><td>POST</td><td><code>/api/v1/campaigns</code></td><td>å»ºç«‹æ´»å‹•</td><td>Admin</td></tr>
                                <tr><td>POST</td><td><code>/api/v1/bids</code></td><td>æäº¤å‡ºåƒ¹</td><td>Required</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/rankings/{id}</code></td><td>å–å¾— Top K æ’å</td><td>-</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/rankings/{id}/me</code></td><td>å–å¾—è‡ªå·±çš„æ’å</td><td>Required</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/orders</code></td><td>æˆ‘çš„è¨‚å–®åˆ—è¡¨</td><td>Required</td></tr>
                                <tr><td>GET</td><td><code>/api/v1/orders/campaign/{id}</code></td><td>æ´»å‹•è¨‚å–®</td><td>Admin</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <h3 style="margin-bottom: 2px;">WebSocket</h3>
                        <p style="font-size: 0.45em; color: #94a3b8; margin: 2px 0;">ç«¯é»ï¼š<code>ws://host/ws/{campaign_id}?token={jwt}</code></p>
                        <table class="small-table" style="font-size: 0.42em;">
                            <thead><tr><th>äº‹ä»¶</th><th>æ–¹å‘</th><th>è§¸ç™¼æ™‚æ©Ÿ</th><th>èªªæ˜</th></tr></thead>
                            <tbody>
                                <tr><td><code>ranking_update</code></td><td>S â†’ C</td><td>æ¯ 2 ç§’</td><td>å»£æ’­ Top K æ’å</td></tr>
                                <tr><td><code>bid_accepted</code></td><td>S â†’ C</td><td>å‡ºåƒ¹æˆåŠŸ</td><td>æ¨é€ç•¶å‰æ’å</td></tr>
                                <tr><td><code>campaign_ended</code></td><td>S â†’ C</td><td>æ´»å‹•çµç®—</td><td>é€šçŸ¥æœ€çµ‚çµæœ</td></tr>
                                <tr><td><code>ping/pong</code></td><td>é›™å‘</td><td>å¿ƒè·³æª¢æ¸¬</td><td>ç¶­æŒé€£ç·š</td></tr>
                            </tbody>
                        </table>
                        <h3 style="margin-top: 8px; margin-bottom: 2px;">æ’åå»£æ’­è³‡æ–™çµæ§‹</h3>
                        <pre style="font-size: 0.38em; margin: 0;"><code class="language-json">{
  "event": "ranking_update",
  "data": {
    "campaign_id": "uuid",
    "top_k": [
      {"rank": 1, "user_id": "...", "score": 15000.5,
       "price": 5000, "username": "..."}
    ],
    "total_participants": 1000,
    "min_winning_score": 12000,
    "max_score": 15000.5
  }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- ========== Slide 13: Demo å½±ç‰‡ ========== -->
            <section>
                <h2>Demo å½±ç‰‡</h2>
                <div style="display: flex; justify-content: center; align-items: center; margin-top: 20px;">
                    <video controls style="max-width: 90%; max-height: 500px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 217, 255, 0.3);">
                        <source src="ds_final_demo.mp4" type="video/mp4">
                        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´ HTML5 å½±ç‰‡æ’­æ”¾ã€‚
                    </video>
                </div>
                <p style="font-size: 0.55em; color: #94a3b8; margin-top: 15px; text-align: center;">
                    é»æ“Šæ’­æ”¾æŒ‰éˆ•è§€çœ‹ç³»çµ± Demo
                </p>
            </section>

            <!-- ========== Slide 14: è¬è¬è†è½ ========== -->
            <section>
                <h1 style="margin-bottom: 15px;">è¬è¬è†è½</h1>
                <div class="two-col" style="gap: 20px; margin-top: 10px;">
                    <div>
                        <h3 style="font-size: 0.85em; color: #00d9ff; margin-bottom: 8px; text-align: center;">æŠ€è¡“æ£§ç¸½è¦½</h3>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 4px;">
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #00d9ff; font-weight: bold;">å‰ç«¯</div>
                                <div style="font-size: 0.45em; color: #94a3b8;">React 18, TypeScript, Vite, Tailwind CSS</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #10b981; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #10b981; font-weight: bold;">å¾Œç«¯</div>
                                <div style="font-size: 0.45em; color: #94a3b8;">FastAPI, Uvicorn, uvloop, SQLAlchemy 2.0</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #f59e0b; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #f59e0b; font-weight: bold;">è³‡æ–™åº«</div>
                                <div style="font-size: 0.45em; color: #94a3b8;">PostgreSQL 15, Redis 7</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #8b5cf6; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #8b5cf6; font-weight: bold;">é€£ç·šæ± </div>
                                <div style="font-size: 0.45em; color: #94a3b8;">PgBouncer (Transaction Mode)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #ef4444; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #ef4444; font-weight: bold;">å®¹å™¨</div>
                                <div style="font-size: 0.45em; color: #94a3b8;">Docker, Kubernetes (GKE Autopilot)</div>
                            </div>
                            <div style="background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #3b82f6; padding: 5px 10px; border-radius: 6px; text-align: left;">
                                <div style="font-size: 0.55em; color: #3b82f6; font-weight: bold;">è² è¼‰å‡è¡¡</div>
                                <div style="font-size: 0.45em; color: #94a3b8;">GCP Ingress (L7)</div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 style="font-size: 0.85em; color: #00d9ff; margin-bottom: 8px; text-align: center;">å°ˆæ¡ˆçµæ§‹</h3>
                        <pre style="margin: 0; font-size: 0.34em; background: #16213e; padding: 8px; border-radius: 6px; line-height: 1.3;"><code style="background: transparent; padding: 0; color: #eaeaea;">flash-sale-system/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ src/app/
â”‚       â”œâ”€â”€ api/v1/           # API è·¯ç”±
â”‚       â”œâ”€â”€ core/             # æ ¸å¿ƒé…ç½®
â”‚       â”œâ”€â”€ middleware/       # ä¸­ä»‹è»Ÿé«”
â”‚       â”œâ”€â”€ models/           # SQLAlchemy æ¨¡å‹
â”‚       â”œâ”€â”€ schemas/          # Pydantic Schema
â”‚       â”œâ”€â”€ services/         # æ¥­å‹™é‚è¼¯
â”‚       â””â”€â”€ main.py
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ api/              # API å®¢æˆ¶ç«¯
â”‚       â”œâ”€â”€ components/       # React å…ƒä»¶
â”‚       â”œâ”€â”€ contexts/         # ç‹€æ…‹ç®¡ç†
â”‚       â”œâ”€â”€ hooks/            # è‡ªè¨‚ Hooks
â”‚       â””â”€â”€ pages/            # é é¢å…ƒä»¶
â”œâ”€â”€ k8s/                      # Kubernetes é…ç½®
â”œâ”€â”€ k6-tests/                 # è² è¼‰æ¸¬è©¦è…³æœ¬
â””â”€â”€ docker-compose.yml        # æœ¬åœ°é–‹ç™¼ç’°å¢ƒ</code></pre>
                        <div style="margin-top: 10px;">
                            <h3 style="font-size: 0.85em; color: #00d9ff; margin-bottom: 6px; text-align: center;">åˆ†å·¥</h3>
                            <div style="display: flex; gap: 8px;">
                                <div style="flex: 1; background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #00d9ff; padding: 6px 10px; border-radius: 6px; text-align: left;">
                                    <div style="font-size: 0.55em; color: #00d9ff; font-weight: bold;">æå¤é§¿</div>
                                    <div style="font-size: 0.42em; color: #94a3b8;">è¨­è¨ˆæ¶æ§‹ Â· éƒ¨ç½²ç³»çµ± Â· æ’°å¯«ç¨‹å¼ç¢¼åŠæ–‡ä»¶</div>
                                </div>
                                <div style="flex: 1; background: linear-gradient(135deg, #0f3460 0%, #16213e 100%); border-left: 3px solid #10b981; padding: 6px 10px; border-radius: 6px; text-align: left;">
                                    <div style="font-size: 0.55em; color: #10b981; font-weight: bold;">é„§åŠ›ç‘‹</div>
                                    <div style="font-size: 0.42em; color: #94a3b8;">å£“åŠ›æ¸¬è©¦ Â· Demo å½±ç‰‡ Â· ç°¡å ±è£½ä½œ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@4.6.1/plugin/highlight/highlight.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: 'c/t',
            plugins: [RevealHighlight],
            transition: 'slide',
            width: 1200,
            height: 700,
            margin: 0.08,
        });
    </script>
</body>
</html>
